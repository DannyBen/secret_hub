require 'debug'
require 'secret_hub'
require 'secret_hub/version'

title   "SecretHub Developer Toolbelt"
summary "Runfile tasks for building the SecretHub gem"
version SecretHub::VERSION

import_gem 'runfile-tasks/gem'
import_gem 'runfile-tasks/docker', image: 'dannyben/secrethub', version: SecretHub::VERSION
import 'debug'

help   "Run test mock server"
usage  "mockserver"
action :mockserver do |args|
  ENV['SINATRA_ACTIVESUPPORT_WARNING'] = 'false'
  exec "bundle exec ruby spec/mock_api/server.rb"
end

help 'Generate changelog and append old changelog'
action :changelog do
  system "git changelog --save"
  system "cat .changelog.old.md >> CHANGELOG.md"
end
